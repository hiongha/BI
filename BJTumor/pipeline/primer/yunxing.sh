perl -e 'my %hash;my ($file1,$file2)=@ARGV;open IN1,"<$file1" or die "can not open IN1";while(<IN1>){chomp;my @a=split;$hash{$a[0]}=$a[1];}close IN1;open IN2,"<$file2" or die "can not open IN2";while(<IN2>){chomp;my @a=split;my @b=split(/:/,$hash{$a[0]});my @c=split(/-/,$b[1]);print ($c[1]-$c[0]+1);print "\t".$b[0]."\t".$c[0]."\t".$c[1]."\t".$_."\t";print ($c[0]+$a[-1]-1);print "\n";}close IN2;' <(grep '>' multiplex.lung.fa | awk '{print $1"\t"$2}' | sed 's/>//g' | sed 's/range=//g') list | perl -e 'my $n=1;while(<>){chomp;my @a=split;if($n==1){print $a[4]."\t".$a[1]."\t".$a[6]."\t";$n++;}else{print $a[6]."\n";$n=1;}}' | awk '{print $1"\t"$2"\t"$3"\t"$4"\t"($4-$3+1+1000)}' | perl -e 'my $sum=0;while(<>){chomp;my @a=split;$sum=$sum+$a[4];}print $sum."\n";'
